<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Bệnh Viện</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary-color: #4a6bff;
            --secondary-color: #ff7e5f;
            --dark-color: #2c3e50;
            --light-color: #f8f9fa;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --sidebar-width: 280px;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7ff;
            color: var(--dark-color);
            overflow-x: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem 0;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            position: relative;
            z-index: 10;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .main-title {
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-top: 0.5rem;
            font-size: 1.8rem;
        }
        
        .nav-tabs {
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }
        
        .nav-tabs .nav-link {
            font-weight: 600;
            color: var(--dark-color);
            border: none;
            padding: 12px 20px;
            position: relative;
            transition: all 0.3s;
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--primary-color);
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            background-color: transparent;
        }
        
        .nav-tabs .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            border-radius: 3px 3px 0 0;
        }
        
        .tab-content {
            background-color: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
            animation: fadeIn 0.4s ease-out;
        }
        
        .form-label {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
            box-shadow: none;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(74, 107, 255, 0.15);
        }
        
        .btn {
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border: none;
        }
        
        .btn-primary:hover {
            background-color: #3a5bef;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 107, 255, 0.3);
        }
        
        .btn-success {
            background-color: var(--success-color);
            border: none;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            border: none;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            border: none;
            color: #212529;
        }
        
        .btn-info {
            background-color: var(--info-color);
            border: none;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.875rem;
        }
        
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .table {
            margin-bottom: 0;
            font-size: 0.95rem;
        }
        
        .table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            padding: 12px 15px;
            vertical-align: middle;
        }
        
        .table td {
            padding: 12px 15px;
            vertical-align: middle;
        }
        
        .table-hover tbody tr {
            transition: all 0.2s ease;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(74, 107, 255, 0.05);
            transform: translateX(4px);
        }
        
        .status-active {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-block;
        }
        
        .status-inactive {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-block;
        }
        
        .status-pending {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-block;
        }
        
        .form-container {
            background-color: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }
        
        .was-validated .form-control:invalid, .form-control.is-invalid {
            border-color: var(--danger-color);
        }
        
        .invalid-feedback {
            color: var(--danger-color);
            font-size: 0.875em;
            margin-top: 0.25rem;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            padding: 1rem 1.5rem;
            font-weight: 600;
        }
        
        .stat-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 15px;
            color: white;
            margin-bottom: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .stat-card .count {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stat-card .label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .patients-card {
            background: linear-gradient(135deg, #4a6bff, #6a8cff);
        }
        
        .clinics-card {
            background: linear-gradient(135deg, #ff7e5f, #ff9e7f);
        }
        
        .appointments-card {
            background: linear-gradient(135deg, #28a745, #48c765);
        }
        
        .today-card {
            background: linear-gradient(135deg, #17a2b8, #37c2d8);
        }
        
        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .search-box input {
            padding-left: 40px;
            border-radius: 50px;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .badge-notification {
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.6rem;
            padding: 3px 6px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        
        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
            border: 2px solid white;
        }
        
        .user-name {
            font-weight: 600;
            margin-right: 10px;
            color: white;
        }
        
        .dropdown-menu {
            border: none;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 0.5rem 0;
        }
        
        .dropdown-item {
            padding: 0.5rem 1.5rem;
            transition: all 0.2s;
        }
        
        .dropdown-item:hover {
            background-color: rgba(74, 107, 255, 0.1);
            color: var(--primary-color);
        }
        
        .modal-content {
            border: none;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .modal-header {
            background-color: var(--primary-color);
            color: white;
            border-bottom: none;
            padding: 1.2rem 1.5rem;
        }
        
        .modal-title {
            font-weight: 600;
        }
        
        .modal-footer {
            border-top: none;
            padding: 1rem 1.5rem;
        }
        
        .btn-close {
            filter: invert(1);
        }
        
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
        }
        
        .toast {
            border: none;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .toast-header {
            border-bottom: none;
            font-weight: 600;
        }
        
        .toast-success .toast-header {
            background-color: rgba(40, 167, 69, 0.2);
            color: var(--success-color);
        }
        
        .toast-error .toast-header {
            background-color: rgba(220, 53, 69, 0.2);
            color: var(--danger-color);
        }
        
        .toast-warning .toast-header {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 2rem;
        }
        
        .action-buttons .btn {
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 1rem 0;
            }
            
            .main-title {
                font-size: 1.5rem;
            }
            
            .logo {
                width: 60px;
                height: 60px;
            }
            
            .nav-tabs .nav-link {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .tab-content {
                padding: 1.5rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
            
            .stat-card .count {
                font-size: 1.5rem;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeTab {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes highlightFade {
            0% { background-color: #fff3cd; }
            35% { background-color: #fff8e1; }
            100% { background-color: transparent; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #3a5bef;
        }
        
        /* Print styles */
        @media print {
            .no-print, .header, .nav-tabs, .btn, .search-box, .modal, .toast-container {
                display: none !important;
            }
            
            body {
                background-color: white;
                color: black;
                font-size: 12pt;
            }
            
            .table {
                font-size: 10pt;
            }
            
            .table th {
                background-color: #f8f9fa !important;
                color: black !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header class="header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <img src="https://cdn-icons-png.flaticon.com/512/2969/2969398.png" alt="Logo Bệnh Viện" class="logo me-3">
                    <div>
                        <h1 class="main-title mb-0">HỆ THỐNG QUẢN LÝ BỆNH VIỆN</h1>
                        <p class="mb-0 d-none d-md-block">Quản lý bệnh nhân, phòng khám và lịch hẹn chuyên nghiệp</p>
                    </div>
                </div>
                
                <div class="dropdown">
                    <div class="user-profile dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=4a6bff&color=fff" alt="User Avatar" class="user-avatar">
                        <span class="user-name d-none d-md-inline">Admin</span>
                        <i class="fas fa-chevron-down text-white"></i>
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Thông tin tài khoản</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Cài đặt</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-sign-out-alt me-2"></i>Đăng xuất</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stat-card patients-card">
                    <i class="fas fa-user-injured"></i>
                    <div class="count" th:text="${danhSachBenhNhan.size()}">0</div>
                    <div class="label">Bệnh nhân</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card clinics-card">
                    <i class="fas fa-clinic-medical"></i>
                    <div class="count" th:text="${danhSachPhongKham.size()}">0</div>
                    <div class="label">Phòng khám</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card appointments-card">
                    <i class="fas fa-calendar-check"></i>
                    <div class="count" th:text="${danhSachGiaoDich.size()}">0</div>
                    <div class="label">Lịch hẹn</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card today-card pulse">
                    <i class="fas fa-clock"></i>
                    <div class="count" th:text="${lichHenHomNay != null ? lichHenHomNay.size() : 0}">0</div>
                    <div class="label">Hẹn hôm nay</div>
                </div>
            </div>
        </div>
        
        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="patients-tab" data-bs-toggle="tab" data-bs-target="#patients" type="button" role="tab">
                    <i class="fas fa-user-injured me-2"></i>Bệnh nhân
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="clinics-tab" data-bs-toggle="tab" data-bs-target="#clinics" type="button" role="tab">
                    <i class="fas fa-clinic-medical me-2"></i>Phòng khám
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="appointments-tab" data-bs-toggle="tab" data-bs-target="#appointments" type="button" role="tab">
                    <i class="fas fa-calendar-check me-2"></i>Lịch hẹn
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button" role="tab">
                    <i class="fas fa-chart-bar me-2"></i>Báo cáo
                </button>
            </li>
        </ul>
        
        <!-- Tab Contents -->
        <div class="tab-content" id="myTabContent">
            <!-- Patients Tab -->
            <div class="tab-pane fade show active" id="patients" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3><i class="fas fa-user-injured me-2"></i>Quản lý Bệnh nhân</h3>
                    <div>
                        <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addPatientModal">
                            <i class="fas fa-plus me-2"></i>Thêm bệnh nhân
                        </button>
                        <button class="btn btn-outline-secondary" onclick="window.print()">
                            <i class="fas fa-print me-2"></i>In danh sách
                        </button>
                    </div>
                </div>
                
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" class="form-control" id="patientSearch" placeholder="Tìm kiếm bệnh nhân...">
                </div>
                
                <div class="table-responsive">
                    <table class="table table-hover" id="patientsTable">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Tên bệnh nhân</th>
                                <th>Số điện thoại</th>
                                <th>Địa chỉ</th>
                                <th>Lần cuối khám</th>
                                <th>Hành động</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="benhNhan, stat : ${danhSachBenhNhan}">
                                <td th:text="${stat.index + 1}"></td>
                                <td>
                                    <div class="fw-bold" th:text="${benhNhan.ten}"></div>
                                    <small class="text-muted" th:text="${benhNhan.ngaySinh} ? 'Ngày sinh: ' + ${benhNhan.ngaySinh} : 'Chưa cập nhật'"></small>
                                </td>
                                <td th:text="${benhNhan.soDienThoai}"></td>
                                <td th:text="${benhNhan.diaChi} ? ${benhNhan.diaChi} : 'Chưa cập nhật'"></td>
                                <td th:text="${benhNhan.lanCuoiKham} ? ${benhNhan.lanCuoiKham} : 'Chưa có dữ liệu'"></td>
                                <td class="action-buttons">
                                    <button class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#viewPatientModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#editPatientModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" th:onclick="'deletePatient(' + ${stat.index} + ')'">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <nav aria-label="Page navigation" class="mt-4">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Trước</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#">Sau</a>
                        </li>
                    </ul>
                </nav>
            </div>
            
            <!-- Clinics Tab -->
            <div class="tab-pane fade" id="clinics" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3><i class="fas fa-clinic-medical me-2"></i>Quản lý Phòng khám</h3>
                    <div>
                        <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addClinicModal">
                            <i class="fas fa-plus me-2"></i>Thêm phòng khám
                        </button>
                        <button class="btn btn-outline-secondary" onclick="window.print()">
                            <i class="fas fa-print me-2"></i>In danh sách
                        </button>
                    </div>
                </div>
                
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" class="form-control" id="clinicSearch" placeholder="Tìm kiếm phòng khám...">
                </div>
                
                <div class="table-responsive">
                    <table class="table table-hover" id="clinicsTable">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Tên phòng</th>
                                <th>Chuyên khoa</th>
                                <th>Bác sĩ phụ trách</th>
                                <th>Trạng thái</th>
                                <th>Hành động</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="phongKham, stat : ${danhSachPhongKham}">
                                <td th:text="${stat.index + 1}"></td>
                                <td>
                                    <div class="fw-bold" th:text="${phongKham.tenPhong}"></div>
                                    <small class="text-muted" th:text="'Mã phòng: ' + ${phongKham.maPhong}"></small>
                                </td>
                                <td th:text="${phongKham.chuyenKhoa}"></td>
                                <td th:text="${phongKham.bacSiPhuTrach} ? ${phongKham.bacSiPhuTrach} : 'Chưa chỉ định'"></td>
                                <td>
                                    <span th:class="${phongKham.trangThai == 'Hoạt động'} ? 'status-active' : 'status-inactive'" 
                                          th:text="${phongKham.trangThai}"></span>
                                </td>
                                <td class="action-buttons">
                                    <button class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#viewClinicModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#editClinicModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" th:onclick="'deleteClinic(' + ${stat.index} + ')'">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Appointments Tab -->
            <div class="tab-pane fade" id="appointments" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3><i class="fas fa-calendar-check me-2"></i>Quản lý Lịch hẹn</h3>
                    <div>
                        <button class="btn btn-outline-secondary me-2" onclick="window.print()">
                            <i class="fas fa-print me-2"></i>In danh sách
                        </button>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#quickAppointmentModal">
                            <i class="fas fa-plus me-2"></i>Tạo lịch hẹn nhanh
                        </button>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" id="appointmentSearch" placeholder="Tìm kiếm lịch hẹn...">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                            <input type="text" class="form-control" id="appointmentDateFilter" placeholder="Lọc theo ngày...">
                            <button class="btn btn-outline-secondary" type="button" id="clearDateFilter">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="form-container mb-4">
                    <h4><i class="fas fa-plus-circle me-2"></i>Tạo lịch hẹn mới</h4>
                    <form id="appointmentForm" th:action="@{/themGiaoDich}" method="post" novalidate>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Bệnh nhân <span class="text-danger">*</span></label>
                                <select class="form-select" name="benhNhanIndex" required>
                                    <option value="" selected disabled>-- Chọn bệnh nhân --</option>
                                    <option th:each="benhNhan, stat : ${danhSachBenhNhan}" 
                                            th:value="${stat.index}"
                                            th:text="${benhNhan.ten} + ' - ' + ${benhNhan.soDienThoai}">
                                    </option>
                                </select>
                                <div class="invalid-feedback">Vui lòng chọn bệnh nhân</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Phòng khám <span class="text-danger">*</span></label>
                                <select class="form-select" name="phongKhamIndex" required>
                                    <option value="" selected disabled>-- Chọn phòng khám --</option>
                                    <option th:each="phongKham, stat : ${danhSachPhongKham}" 
                                            th:value="${stat.index}"
                                            th:text="${phongKham.tenPhong} + ' (' + ${phongKham.chuyenKhoa} + ')'">
                                    </option>
                                </select>
                                <div class="invalid-feedback">Vui lòng chọn phòng khám</div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Ngày hẹn <span class="text-danger">*</span></label>
                                <input type="date" class="form-control" name="ngayHen" required min="" th:attr="min=${ngayHienTai}">
                                <div class="invalid-feedback">Vui lòng chọn ngày hẹn</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Giờ hẹn <span class="text-danger">*</span></label>
                                <input type="time" class="form-control" name="gioHen" required>
                                <div class="invalid-feedback">Vui lòng chọn giờ hẹn</div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ghi chú</label>
                            <textarea class="form-control" name="ghiChu" rows="2" placeholder="Nhập ghi chú (nếu có)"></textarea>
                        </div>
                        
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Lưu lịch hẹn
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-hover" id="appointmentsTable">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Bệnh nhân</th>
                                <th>Phòng khám</th>
                                <th>Thời gian</th>
                                <th>Trạng thái</th>
                                <th>Hành động</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="giaoDich, stat : ${danhSachGiaoDich}">
                                <td th:text="${stat.index + 1}"></td>
                                <td>
                                    <div class="fw-bold" th:text="${giaoDich.benhNhan.ten}"></div>
                                    <small class="text-muted" th:text="${giaoDich.benhNhan.soDienThoai}"></small>
                                </td>
                                <td>
                                    <div th:text="${giaoDich.phongKham.tenPhong}"></div>
                                    <small class="text-muted" th:text="${giaoDich.phongKham.chuyenKhoa}"></small>
                                </td>
                                <td>
                                    <div class="fw-bold" th:text="${giaoDich.thoiGian}"></div>
                                    <small class="text-muted" th:text="${giaoDich.ngayHen}"></small>
                                </td>
                                <td>
                                    <span th:class="${giaoDich.trangThai == 'Đã đặt'} ? 'status-active' : 
                                          (${giaoDich.trangThai == 'Đã hủy'} ? 'status-inactive' : 'status-pending')" 
                                          th:text="${giaoDich.trangThai}"></span>
                                </td>
                                <td class="action-buttons">
                                    <button class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#viewAppointmentModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#editAppointmentModal" th:attr="data-bs-id=${stat.index}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" th:onclick="'deleteAppointment(' + ${stat.index} + ')'">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Reports Tab -->
            <div class="tab-pane fade" id="reports" role="tabpanel">
                <h3 class="mb-4"><i class="fas fa-chart-bar me-2"></i>Báo cáo & Thống kê</h3>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-line me-2"></i>Thống kê lịch hẹn theo tháng
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="appointmentsChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-pie me-2"></i>Phân bổ bệnh nhân theo chuyên khoa
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="specialtiesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-table me-2"></i>Báo cáo lịch hẹn hôm nay
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Bệnh nhân</th>
                                        <th>Phòng khám</th>
                                        <th>Thời gian</th>
                                        <th>Trạng thái</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="lichHen, stat : ${lichHenHomNay}">
                                        <td th:text="${stat.index + 1}"></td>
                                        <td th:text="${lichHen.benhNhan.ten} + ' - ' + ${lichHen.benhNhan.soDienThoai}"></td>
                                        <td th:text="${lichHen.phongKham.tenPhong} + ' (' + ${lichHen.phongKham.chuyenKhoa} + ')'"></td>
                                        <td th:text="${lichHen.thoiGian}"></td>
                                        <td><span class="status-active">Đã đặt</span></td>
                                    </tr>
                                    <tr th:if="${lichHenHomNay == null or lichHenHomNay.isEmpty()}">
                                        <td colspan="5" class="text-center text-muted">Không có lịch hẹn nào hôm nay</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card-footer text-end">
                        <button class="btn btn-primary" onclick="window.print()">
                            <i class="fas fa-print me-2"></i>In báo cáo
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notifications -->
    <div class="toast-container">
        <div class="toast toast-success" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000">
            <div class="toast-header">
                <strong class="me-auto">Thành công</strong>
                <small>Vừa xong</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Thao tác đã được thực hiện thành công!
            </div>
        </div>
        
        <div class="toast toast-error" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000">
            <div class="toast-header">
                <strong class="me-auto">Lỗi</strong>
                <small>Vừa xong</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Đã xảy ra lỗi khi thực hiện thao tác!
            </div>
        </div>
    </div>
    
    <!-- Add Patient Modal -->
    <div class="modal fade" id="addPatientModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Thêm bệnh nhân mới</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="patientForm" th:action="@{/themBenhNhan}" method="post" novalidate>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Họ và tên <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="ten" required minlength="3">
                                    <div class="invalid-feedback">Vui lòng nhập tên bệnh nhân (ít nhất 3 ký tự)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Ngày sinh</label>
                                    <input type="date" class="form-control" name="ngaySinh">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Giới tính</label>
                                    <select class="form-select" name="gioiTinh">
                                        <option value="Nam">Nam</option>
                                        <option value="Nữ">Nữ</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Số điện thoại <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="soDienThoai" required 
                                           pattern="[0-9]{10}" title="Số điện thoại 10 chữ số">
                                    <div class="invalid-feedback">Vui lòng nhập số điện thoại hợp lệ (10 chữ số)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Địa chỉ</label>
                                    <input type="text" class="form-control" name="diaChi">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Bảo hiểm y tế</label>
                                    <input type="text" class="form-control" name="baoHiemYTe" placeholder="Nhập số thẻ BHYT (nếu có)">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ghi chú</label>
                            <textarea class="form-control" name="ghiChu" rows="2" placeholder="Nhập ghi chú (nếu có)"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu bệnh nhân</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- View Patient Modal -->
    <div class="modal fade" id="viewPatientModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user me-2"></i>Thông tin bệnh nhân</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Patient Avatar" class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                            <h4 id="viewPatientName">Nguyễn Văn A</h4>
                            <span class="badge bg-primary" id="viewPatientId">ID: BN001</span>
                        </div>
                        <div class="col-md-8">
                            <div class="table-responsive">
                                <table class="table table-borderless">
                                    <tbody>
                                        <tr>
                                            <th width="30%">Ngày sinh:</th>
                                            <td id="viewPatientDob">01/01/1990</td>
                                        </tr>
                                        <tr>
                                            <th>Giới tính:</th>
                                            <td id="viewPatientGender">Nam</td>
                                        </tr>
                                        <tr>
                                            <th>Số điện thoại:</th>
                                            <td id="viewPatientPhone">0987654321</td>
                                        </tr>
                                        <tr>
                                            <th>Địa chỉ:</th>
                                            <td id="viewPatientAddress">123 Đường ABC, Quận XYZ, TP.HCM</td>
                                        </tr>
                                        <tr>
                                            <th>Bảo hiểm y tế:</th>
                                            <td id="viewPatientInsurance">BH123456789</td>
                                        </tr>
                                        <tr>
                                            <th>Lần cuối khám:</th>
                                            <td id="viewPatientLastVisit">15/05/2023</td>
                                        </tr>
                                        <tr>
                                            <th>Ghi chú:</th>
                                            <td id="viewPatientNotes">Không có ghi chú</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="printPatientInfo()"><i class="fas fa-print me-2"></i>In thông tin</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Patient Modal -->
    <div class="modal fade" id="editPatientModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-edit me-2"></i>Cập nhật bệnh nhân</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editPatientForm" th:action="@{/capNhatBenhNhan}" method="post" novalidate>
                        <input type="hidden" name="patientIndex" id="editPatientIndex">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Họ và tên <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="ten" id="editPatientName" required minlength="3">
                                    <div class="invalid-feedback">Vui lòng nhập tên bệnh nhân (ít nhất 3 ký tự)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Ngày sinh</label>
                                    <input type="date" class="form-control" name="ngaySinh" id="editPatientDob">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Giới tính</label>
                                    <select class="form-select" name="gioiTinh" id="editPatientGender">
                                        <option value="Nam">Nam</option>
                                        <option value="Nữ">Nữ</option>
                                        <option value="Khác">Khác</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Số điện thoại <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="soDienThoai" id="editPatientPhone" required 
                                           pattern="[0-9]{10}" title="Số điện thoại 10 chữ số">
                                    <div class="invalid-feedback">Vui lòng nhập số điện thoại hợp lệ (10 chữ số)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Địa chỉ</label>
                                    <input type="text" class="form-control" name="diaChi" id="editPatientAddress">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Bảo hiểm y tế</label>
                                    <input type="text" class="form-control" name="baoHiemYTe" id="editPatientInsurance" placeholder="Nhập số thẻ BHYT (nếu có)">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ghi chú</label>
                            <textarea class="form-control" name="ghiChu" id="editPatientNotes" rows="2" placeholder="Nhập ghi chú (nếu có)"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Cập nhật</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Clinic Modal -->
    <div class="modal fade" id="addClinicModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-clinic-medical me-2"></i>Thêm phòng khám mới</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="clinicForm" th:action="@{/themPhongKham}" method="post" novalidate>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Mã phòng <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="maPhong" required>
                                    <div class="invalid-feedback">Vui lòng nhập mã phòng</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Tên phòng <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="tenPhong" required minlength="3">
                                    <div class="invalid-feedback">Vui lòng nhập tên phòng (ít nhất 3 ký tự)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Chuyên khoa <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="chuyenKhoa" required>
                                    <div class="invalid-feedback">Vui lòng nhập chuyên khoa</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Bác sĩ phụ trách</label>
                                    <input type="text" class="form-control" name="bacSiPhuTrach">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Trạng thái</label>
                                    <select class="form-select" name="trangThai">
                                        <option value="Hoạt động" selected>Hoạt động</option>
                                        <option value="Bảo trì">Bảo trì</option>
                                        <option value="Đóng cửa">Đóng cửa</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Mô tả</label>
                                    <textarea class="form-control" name="moTa" rows="2" placeholder="Nhập mô tả phòng khám (nếu có)"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu phòng khám</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- View Clinic Modal -->
    <div class="modal fade" id="viewClinicModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-clinic-medical me-2"></i>Thông tin phòng khám</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <img src="https://cdn-icons-png.flaticon.com/512/2969/2969398.png" alt="Clinic Image" class="img-fluid rounded mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                            <h4 id="viewClinicName">Phòng khám Nội tổng quát</h4>
                            <span class="badge bg-primary" id="viewClinicId">PK001</span>
                        </div>
                        <div class="col-md-8">
                            <div class="table-responsive">
                                <table class="table table-borderless">
                                    <tbody>
                                        <tr>
                                            <th width="30%">Chuyên khoa:</th>
                                            <td id="viewClinicSpecialty">Nội tổng quát</td>
                                        </tr>
                                        <tr>
                                            <th>Bác sĩ phụ trách:</th>
                                            <td id="viewClinicDoctor">BS. Nguyễn Văn A</td>
                                        </tr>
                                        <tr>
                                            <th>Trạng thái:</th>
                                            <td><span class="status-active" id="viewClinicStatus">Hoạt động</span></td>
                                        </tr>
                                        <tr>
                                            <th>Lịch làm việc:</th>
                                            <td id="viewClinicSchedule">Thứ 2 - Thứ 6: 7h30 - 17h00</td>
                                        </tr>
                                        <tr>
                                            <th>Mô tả:</th>
                                            <td id="viewClinicDescription">Phòng khám chuyên về nội tổng quát, khám và điều trị các bệnh lý thông thường.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="printClinicInfo()"><i class="fas fa-print me-2"></i>In thông tin</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Clinic Modal -->
    <div class="modal fade" id="editClinicModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-edit me-2"></i>Cập nhật phòng khám</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editClinicForm" th:action="@{/capNhatPhongKham}" method="post" novalidate>
                        <input type="hidden" name="clinicIndex" id="editClinicIndex">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Mã phòng <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="maPhong" id="editClinicCode" required>
                                    <div class="invalid-feedback">Vui lòng nhập mã phòng</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Tên phòng <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="tenPhong" id="editClinicName" required minlength="3">
                                    <div class="invalid-feedback">Vui lòng nhập tên phòng (ít nhất 3 ký tự)</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Chuyên khoa <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="chuyenKhoa" id="editClinicSpecialty" required>
                                    <div class="invalid-feedback">Vui lòng nhập chuyên khoa</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Bác sĩ phụ trách</label>
                                    <input type="text" class="form-control" name="bacSiPhuTrach" id="editClinicDoctor">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Trạng thái</label>
                                    <select class="form-select" name="trangThai" id="editClinicStatus">
                                        <option value="Hoạt động">Hoạt động</option>
                                        <option value="Bảo trì">Bảo trì</option>
                                        <option value="Đóng cửa">Đóng cửa</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Mô tả</label>
                                    <textarea class="form-control" name="moTa" id="editClinicDescription" rows="2" placeholder="Nhập mô tả phòng khám (nếu có)"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Cập nhật</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Appointment Modal -->
    <div class="modal fade" id="quickAppointmentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-plus me-2"></i>Tạo lịch hẹn nhanh</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="quickAppointmentForm" th:action="@{/themGiaoDichNhanh}" method="post" novalidate>
                        <div class="mb-3">
                            <label class="form-label">Bệnh nhân <span class="text-danger">*</span></label>
                            <select class="form-select" name="benhNhanIndex" required>
                                <option value="" selected disabled>-- Chọn bệnh nhân --</option>
                                <option th:each="benhNhan, stat : ${danhSachBenhNhan}" 
                                        th:value="${stat.index}"
                                        th:text="${benhNhan.ten} + ' - ' + ${benhNhan.soDienThoai}">
                                </option>
                            </select>
                            <div class="invalid-feedback">Vui lòng chọn bệnh nhân</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Phòng khám <span class="text-danger">*</span></label>
                            <select class="form-select" name="phongKhamIndex" required>
                                <option value="" selected disabled>-- Chọn phòng khám --</option>
                                <option th:each="phongKham, stat : ${danhSachPhongKham}" 
                                        th:value="${stat.index}"
                                        th:text="${phongKham.tenPhong} + ' (' + ${phongKham.chuyenKhoa} + ')'">
                                </option>
                            </select>
                            <div class="invalid-feedback">Vui lòng chọn phòng khám</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Thời gian <span class="text-danger">*</span></label>
                            <input type="datetime-local" class="form-control" name="thoiGian" required min="" th:attr="min=${ngayHienTai} + 'T00:00'">
                            <div class="invalid-feedback">Vui lòng chọn thời gian hợp lệ</div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu lịch hẹn</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- View Appointment Modal -->
    <div class="modal fade" id="viewAppointmentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-check me-2"></i>Chi tiết lịch hẹn</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-borderless">
                            <tbody>
                                <tr>
                                    <th width="40%">Mã lịch hẹn:</th>
                                    <td id="viewAppointmentId">LH001</td>
                                </tr>
                                <tr>
                                    <th>Bệnh nhân:</th>
                                    <td id="viewAppointmentPatient">Nguyễn Văn A - 0987654321</td>
                                </tr>
                                <tr>
                                    <th>Phòng khám:</th>
                                    <td id="viewAppointmentClinic">Phòng khám Nội tổng quát (Nội tổng quát)</td>
                                </tr>
                                <tr>
                                    <th>Thời gian:</th>
                                    <td id="viewAppointmentTime">14:00, 20/05/2023</td>
                                </tr>
                                <tr>
                                    <th>Trạng thái:</th>
                                    <td><span class="status-active" id="viewAppointmentStatus">Đã đặt</span></td>
                                </tr>
                                <tr>
                                    <th>Ngày tạo:</th>
                                    <td id="viewAppointmentCreated">18/05/2023 09:30</td>
                                </tr>
                                <tr>
                                    <th>Ghi chú:</th>
                                    <td id="viewAppointmentNotes">Không có ghi chú</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="printAppointmentInfo()"><i class="fas fa-print me-2"></i>In thông tin</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Appointment Modal -->
    <div class="modal fade" id="editAppointmentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-edit me-2"></i>Cập nhật lịch hẹn</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editAppointmentForm" th:action="@{/capNhatGiaoDich}" method="post" novalidate>
                        <input type="hidden" name="appointmentIndex" id="editAppointmentIndex">
                        <div class="mb-3">
                            <label class="form-label">Bệnh nhân <span class="text-danger">*</span></label>
                            <select class="form-select" name="benhNhanIndex" id="editAppointmentPatient" required>
                                <option value="" selected disabled>-- Chọn bệnh nhân --</option>
                                <option th:each="benhNhan, stat : ${danhSachBenhNhan}" 
                                        th:value="${stat.index}"
                                        th:text="${benhNhan.ten} + ' - ' + ${benhNhan.soDienThoai}">
                                </option>
                            </select>
                            <div class="invalid-feedback">Vui lòng chọn bệnh nhân</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Phòng khám <span class="text-danger">*</span></label>
                            <select class="form-select" name="phongKhamIndex" id="editAppointmentClinic" required>
                                <option value="" selected disabled>-- Chọn phòng khám --</option>
                                <option th:each="phongKham, stat : ${danhSachPhongKham}" 
                                        th:value="${stat.index}"
                                        th:text="${phongKham.tenPhong} + ' (' + ${phongKham.chuyenKhoa} + ')'">
                                </option>
                            </select>
                            <div class="invalid-feedback">Vui lòng chọn phòng khám</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Thời gian <span class="text-danger">*</span></label>
                            <input type="datetime-local" class="form-control" name="thoiGian" id="editAppointmentTime" required min="" th:attr="min=${ngayHienTai} + 'T00:00'">
                            <div class="invalid-feedback">Vui lòng chọn thời gian hợp lệ</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Trạng thái</label>
                            <select class="form-select" name="trangThai" id="editAppointmentStatus">
                                <option value="Đã đặt">Đã đặt</option>
                                <option value="Đã hoàn thành">Đã hoàn thành</option>
                                <option value="Đã hủy">Đã hủy</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ghi chú</label>
                            <textarea class="form-control" name="ghiChu" id="editAppointmentNotes" rows="2" placeholder="Nhập ghi chú (nếu có)"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Đóng</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Cập nhật</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Xử lý validate form
        (function() {
            'use strict';
            
            // Lấy tất cả các form cần validate
            const forms = document.querySelectorAll('.needs-validation');
            
            // Lặp lại và ngăn chặn submit nếu không hợp lệ
            Array.from(forms).forEach(function(form) {
                form.addEventListener('submit', function(event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
            
            // Validate form thêm bệnh nhân
            const patientForm = document.getElementById('patientForm');
            if (patientForm) {
                patientForm.addEventListener('submit', function(event) {
                    if (!patientForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    patientForm.classList.add('was-validated');
                });
            }
            
            // Validate form thêm phòng khám
            const clinicForm = document.getElementById('clinicForm');
            if (clinicForm) {
                clinicForm.addEventListener('submit', function(event) {
                    if (!clinicForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    clinicForm.classList.add('was-validated');
                });
            }
            
            // Validate form lịch hẹn
            const appointmentForm = document.getElementById('appointmentForm');
            if (appointmentForm) {
                appointmentForm.addEventListener('submit', function(event) {
                    if (!appointmentForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    appointmentForm.classList.add('was-validated');
                });
            }
            
            // Validate form lịch hẹn nhanh
            const quickAppointmentForm = document.getElementById('quickAppointmentForm');
            if (quickAppointmentForm) {
                quickAppointmentForm.addEventListener('submit', function(event) {
                    if (!quickAppointmentForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    quickAppointmentForm.classList.add('was-validated');
                });
            }
            
            // Validate form chỉnh sửa bệnh nhân
            const editPatientForm = document.getElementById('editPatientForm');
            if (editPatientForm) {
                editPatientForm.addEventListener('submit', function(event) {
                    if (!editPatientForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    editPatientForm.classList.add('was-validated');
                });
            }
            
            // Validate form chỉnh sửa phòng khám
            const editClinicForm = document.getElementById('editClinicForm');
            if (editClinicForm) {
                editClinicForm.addEventListener('submit', function(event) {
                    if (!editClinicForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    editClinicForm.classList.add('was-validated');
                });
            }
            
            // Validate form chỉnh sửa lịch hẹn
            const editAppointmentForm = document.getElementById('editAppointmentForm');
            if (editAppointmentForm) {
                editAppointmentForm.addEventListener('submit', function(event) {
                    if (!editAppointmentForm.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    editAppointmentForm.classList.add('was-validated');
                });
            }
        })();
        
        // Xử lý xóa bệnh nhân
        function deletePatient(index) {
            if (confirm('Bạn có chắc chắn muốn xóa bệnh nhân này?')) {
                window.location.href = '/xoaBenhNhan/' + index;
            }
        }
        
        // Xử lý xóa phòng khám
        function deleteClinic(index) {
            if (confirm('Bạn có chắc chắn muốn xóa phòng khám này?')) {
                window.location.href = '/xoaPhongKham/' + index;
            }
        }
        
        // Xử lý xóa lịch hẹn
        function deleteAppointment(index) {
            if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {
                window.location.href = '/xoaGiaoDich/' + index;
            }
        }
        
        // Tự động đóng modal sau khi submit thành công
        document.addEventListener('DOMContentLoaded', function() {
            // Bệnh nhân
            const patientModal = document.getElementById('addPatientModal');
            if (patientModal) {
                patientModal.addEventListener('hidden.bs.modal', function() {
                    const form = document.getElementById('patientForm');
                    if (form) {
                        form.reset();
                        form.classList.remove('was-validated');
                    }
                });
            }
            
            // Phòng khám
            const clinicModal = document.getElementById('addClinicModal');
            if (clinicModal) {
                clinicModal.addEventListener('hidden.bs.modal', function() {
                    const form = document.getElementById('clinicForm');
                    if (form) {
                        form.reset();
                        form.classList.remove('was-validated');
                    }
                });
            }
            
            // Lịch hẹn nhanh
            const quickAppointmentModal = document.getElementById('quickAppointmentModal');
            if (quickAppointmentModal) {
                quickAppointmentModal.addEventListener('hidden.bs.modal', function() {
                    const form = document.getElementById('quickAppointmentForm');
                    if (form) {
                        form.reset();
                        form.classList.remove('was-validated');
                    }
                });
            }
            
            // Khởi tạo flatpickr cho lọc ngày
            if (document.getElementById('appointmentDateFilter')) {
                flatpickr("#appointmentDateFilter", {
                    dateFormat: "d/m/Y",
                    allowInput: true,
                    onClose: function(selectedDates, dateStr, instance) {
                        filterAppointmentsByDate(dateStr);
                    }
                });
            }
            
            // Xử lý nút xóa lọc ngày
            if (document.getElementById('clearDateFilter')) {
                document.getElementById('clearDateFilter').addEventListener('click', function() {
                    document.getElementById('appointmentDateFilter').value = '';
                    filterAppointmentsByDate('');
                });
            }
            
            // Khởi tạo tìm kiếm bệnh nhân
            if (document.getElementById('patientSearch')) {
                document.getElementById('patientSearch').addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const rows = document.querySelectorAll('#patientsTable tbody tr');
                    
                    rows.forEach(row => {
                        const name = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                        const phone = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
                        const address = row.querySelector('td:nth-child(4)').textContent.toLowerCase();
                        
                        if (name.includes(searchTerm) || phone.includes(searchTerm) || address.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
            }
            
            // Khởi tạo tìm kiếm phòng khám
            if (document.getElementById('clinicSearch')) {
                document.getElementById('clinicSearch').addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const rows = document.querySelectorAll('#clinicsTable tbody tr');
                    
                    rows.forEach(row => {
                        const name = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                        const specialty = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
                        const doctor = row.querySelector('td:nth-child(4)').textContent.toLowerCase();
                        
                        if (name.includes(searchTerm) || specialty.includes(searchTerm) || doctor.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
            }
            
            // Khởi tạo tìm kiếm lịch hẹn
            if (document.getElementById('appointmentSearch')) {
                document.getElementById('appointmentSearch').addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const rows = document.querySelectorAll('#appointmentsTable tbody tr');
                    
                    rows.forEach(row => {
                        const patient = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                        const clinic = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
                        const time = row.querySelector('td:nth-child(4)').textContent.toLowerCase();
                        
                        if (patient.includes(searchTerm) || clinic.includes(searchTerm) || time.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
            }
            
            // Xử lý modal xem thông tin bệnh nhân
            if (document.getElementById('viewPatientModal')) {
                const viewPatientModal = document.getElementById('viewPatientModal');
                viewPatientModal.addEventListener('show.bs.modal', function(event) {
                    const button = event.relatedTarget;
                    const patientIndex = button.getAttribute('data-bs-id');
                    
                    // Giả lập dữ liệu - trong thực tế sẽ gọi API hoặc dữ liệu từ server
                    const patients = [
                        {
                            id: 'BN001',
                            ten: 'Nguyễn Văn A',
                            ngaySinh: '01/01/1990',
                            gioiTinh: 'Nam',
                            soDienThoai: '0987654321',
                            diaChi: '123 Đường ABC, Quận XYZ, TP.HCM',
                            baoHiemYTe: 'BH123456789',
                            lanCuoiKham: '15/05/2023',
                            ghiChu: 'Dị ứng với penicillin'
                        }
                    ];
                    
                    const patient = patients[patientIndex] || patients[0];
                    
                    document.getElementById('viewPatientName').textContent = patient.ten;
                    document.getElementById('viewPatientId').textContent = 'ID: ' + patient.id;
                    document.getElementById('viewPatientDob').textContent = patient.ngaySinh;
                    document.getElementById('viewPatientGender').textContent = patient.gioiTinh;
                    document.getElementById('viewPatientPhone').textContent = patient.soDienThoai;
                    document.getElementById('viewPatientAddress').textContent = patient.diaChi;
                    document.getElementById('viewPatientInsurance').textContent = patient.baoHiemYTe;
                    document.getElementById('viewPatientLastVisit').textContent = patient.lanCuoiKham;
                    document.getElementById('viewPatientNotes').textContent = patient.ghiChu || 'Không có ghi chú';
                });
            }
            
            // Xử lý modal chỉnh sửa bệnh nhân
            if (document.getElementById('editPatientModal')) {
                const editPatientModal = document.getElementById('editPatientModal');
                editPatientModal.addEventListener('show.bs.modal', function(event) {
                    const button = event.relatedTarget;
                    const patientIndex = button.getAttribute('data-bs-id');
                    
                    // Giả lập dữ liệu - trong thực tế sẽ gọi API hoặc dữ liệu từ server
                    const patients = [
                        {
                            id: 'BN001',
                            ten: 'Nguyễn Văn A',
                            ngaySinh: '1990-01-01',
                            gioiTinh: 'Nam',
                            soDienThoai: '0987654321',
                            diaChi: '123 Đường ABC, Quận XYZ, TP.HCM',
                            baoHiemYTe: 'BH123456789',
                            ghiChu: 'Dị ứng với penicillin'
                        }
                    ];
                    
                    const patient = patients[patientIndex] || patients[0];
                    
                    document.getElementById('editPatientIndex').value = patientIndex;
                    document.getElementById('editPatientName').value = patient.ten;
                    document.getElementById('editPatientDob').value = patient.ngaySinh;
                    document.getElementById('editPatientGender').value = patient.gioiTinh;
                    document.getElementById('editPatientPhone').value = patient.soDienThoai;
                    document.getElementById('editPatientAddress').value = patient.diaChi;
                    document.getElementById('editPatientInsurance').value = patient.baoHiemYTe;
                    document.getElementById('editPatientNotes').value = patient.ghiChu || '';
                });
            }
            
            // Xử lý modal xem thông tin phòng khám
            if (document.getElementById('viewClinicModal')) {
                const viewClinicModal = document.getElementById('viewClinicModal');
                viewClinicModal.addEventListener('show.bs.modal', function(event) {
                    const button = event.relatedTarget;
                    const clinicIndex = button.getAttribute('data-bs-id');
                    
                    // Giả lập dữ liệu - trong thực tế sẽ gọi API hoặc dữ liệu từ server
                    const clinics = [
                        {
                            id: 'PK001',
                            tenPhong: 'Phòng khám Nội tổng quát',
                            chuyenKhoa: 'Nội tổng quát',
                            bacSiPhuTrach: 'BS. Nguyễn Văn A',
                            trangThai: 'Hoạt động',
                            lichLamViec: 'Thứ 2 - Thứ 6: 7h30 - 17h00',
                            moTa: 'Phòng khám chuyên về nội tổng quát, khám và điều trị các bệnh lý thông thường.'
                        }
                    ];
                    
                    const clinic = clinics[clinicIndex] || clinics[0];
                    
                    document.getElementById('viewClinicName').textContent = clinic.tenPhong;
                    document.getElementById('viewClinicId').textContent = clinic.id;
                    document.getElementById('viewClinicSpecialty').textContent = clinic.chuyenKhoa;
                    document.getElementById('viewClinicDoctor').textContent = clinic.bacSiPhuTrach;
                    document.getElementById('viewClinicStatus').textContent = clinic.trangThai;
                    document.getElementById('viewClinicStatus').className = clinic.trangThai === 'Hoạt động' ? 'status-active' : 'status-inactive';
                    document.getElementById('viewClinicSchedule').textContent = clinic.lichLamViec;
                    document.getElementById('viewClinicDescription').textContent = clinic.moTa;
                });
            }
            
            // Xử lý modal chỉnh sửa phòng khám
            if (document.getElementById('editClinicModal')) {
                const editClinicModal = document.getElementById('editClinicModal');
                editClinicModal.addEventListener('show.bs.modal', function(event) {
                    const button = event.relatedTarget;
                    const clinicIndex = button.getAttribute('data-bs-id');
                    
                    // Giả lập dữ liệu - trong thực tế sẽ gọi API hoặc dữ liệu từ server
                    const clinics = [
                        {
                            maPhong: 'PK001',
                            tenPhong: 'Phòng khám Nội tổng quát',
                            chuyenKhoa: 'Nội tổng quát',
                            bacSiPhuTrach: 'BS. Nguyễn Văn A',
                            trangThai: 'Hoạt động',
                            moTa: 'Phòng khám chuyên về nội tổng quát, khám và điều trị các bệnh lý thông thường.'
                        }
                    ];
                    
                    const clinic = clinics[clinicIndex] || clinics[0];
                    
                    document.getElementById('editClinicIndex').value = clinicIndex;
                    document.getElementById('editClinicCode').value = clinic.maPhong;
                    document.getElementById('editClinicName').value = clinic.tenPhong;
                    document.getElementById('editClinicSpecialty').value = clinic.chuyenKhoa;
                    document.getElementById('editClinicDoctor').value = clinic.bacSiPhuTrach;
                    document.getElementById('editClinicStatus').value = clinic.trangThai;
                    document.getElementById('editClinicDescription').value = clinic.moTa || '';
                });
            }
            
            // Xử lý modal xem thông tin lịch hẹn
            if (document.getElementById('viewAppointmentModal')) {
                const viewAppointmentModal = document.getElementById('viewAppointmentModal');
                viewAppointmentModal.addEventListener('show.bs.modal', function(event) {
                    const button = event.relatedTarget;
                    const appointmentIndex = button.getAttribute('data-bs-id');
                    
                    // Giả lập dữ liệu - trong thực tế sẽ gọi API hoặc dữ liệu từ server
                    const appointments = [
                        {
                            id: 'LH001',
                            benhNhan: 'Nguyễn Văn A - 0987654321',
                            phongKham: 'Phòng khám Nội tổng quát (Nội tổng quát)',
                            thoiGian: '14:00, 20/05/2023',
                            trangThai: 'Đã đặt',
                            ngayTao: '18/05/2023 09:30',
                            ghiChu: 'Bệnh nhân cần khám lại để kiểm tra huyết áp'
                        }
                    ];
                    
                  // Các hàm xử lý modal
if (document.getElementById('viewAppointmentModal')) {
    const viewAppointmentModal = document.getElementById('viewAppointmentModal');
    viewAppointmentModal.addEventListener('show.bs.modal', function(event) {
        const button = event.relatedTarget;
        const appointmentIndex = button.getAttribute('data-bs-id');
        
        const appointments = [
            {
                id: 'LH001',
                benhNhan: 'Nguyễn Văn A - 0987654321',
                phongKham: 'Phòng khám Nội tổng quát (Nội tổng quát)',
                thoiGian: '14:00, 20/05/2023',
                trangThai: 'Đã đặt',
                ngayTao: '18/05/2023 09:30',
                ghiChu: 'Bệnh nhân cần khám lại để kiểm tra huyết áp'
            }
        ];
        
        const appointment = appointments[appointmentIndex] || appointments[0];
        
        // Cập nhật DOM
        document.getElementById('viewAppointmentId').textContent = appointment.id;
        document.getElementById('viewAppointmentPatient').textContent = appointment.benhNhan;
        document.getElementById('viewAppointmentClinic').textContent = appointment.phongKham;
        document.getElementById('viewAppointmentTime').textContent = appointment.thoiGian;
        document.getElementById('viewAppointmentStatus').textContent = appointment.trangThai;
        document.getElementById('viewAppointmentStatus').className = 
            appointment.trangThai === 'Đã đặt' ? 'status-active' : 
            (appointment.trangThai === 'Đã hủy' ? 'status-inactive' : 'status-pending');
        document.getElementById('viewAppointmentCreated').textContent = appointment.ngayTao;
        document.getElementById('viewAppointmentNotes').textContent = appointment.ghiChu || 'Không có ghi chú';
    });
}

// Hàm in thông tin lịch hẹn (ĐÃ KIỂM TRA KỸ TEMPLATE STRING)
function printAppointmentInfo() {
    const printWindow = window.open('', '', 'width=800,height=600');
    const content = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Thông tin lịch hẹn</title>
            <style>
                body { font-family: Arial; margin: 20px; }
                h2 { color: #4a6bff; text-align: center; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 8px; }
                .header { text-align: center; margin-bottom: 30px; }
                .footer { margin-top: 30px; text-align: right; }
            </style>
        </head>
        <body>
            <div class="header">
                <h2>THÔNG TIN LỊCH HẸN</h2>
            </div>
            <table>
                <!-- Nội dung bảng -->
            </table>
            <div class="footer">
                <p>Ngày in: ${new Date().toLocaleDateString()}</p>
            </div>
        </body>
        </html>
    `;  // ĐÃ ĐÓNG TEMPLATE STRING
    
    printWindow.document.write(content);
    printWindow.document.close();
}

// Phần cuối file
`; // Đóng template literal an toàn (nếu cần)

// Giả lập hiển thị toast
// showToast('success', 'Thao tác thành công');
</script>
</body>
</html>